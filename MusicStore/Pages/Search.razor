@page "/Search"
@using MusicStore.Data
@using MusicStore.Schemas

@inject ProductService ProductService

<div class="topnav">
  <div class="search-container">
    <form action="/action_page.php">
            <form action="/form/submit" method="GET">
                <input type="text" name="text" class="search" placeholder="Search here!">
                <input type="submit" name="submit" class="submit" value="Search">
            </form>
    </form>
  </div>
</div>

<table class="table">
    <tr style="color:white">
    <th>Company</th>
    <th>Contact</th>
    <th>Country</th>
  </tr>
    <tr style="color:white">
    <td>Alfreds Futterkiste</td>
    <td>Maria Anders</td>
    <td>Germany</td>
  </tr>
    <tr style="color:white">
    <td>Centro comercial Moctezuma</td>
    <td>Francisco Chang</td>
    <td>Mexico</td>
  </tr>
    <tr style="color:white">
    <td>Ernst Handel</td>
    <td>Roland Mendel</td>
    <td>Austria</td>
  </tr>
    <tr style="color:white">
    <td>Island Trading</td>
    <td>Helen Bennett</td>
    <td>UK</td>
  </tr>
    <tr style="color:white">
    <td>Laughing Bacchus Winecellars</td>
    <td>Yoshi Tannamuri</td>
    <td>Canada</td>
  </tr>
    <tr style="color:white">
    <td>Magazzini Alimentari Riuniti</td>
    <td>Giovanni Rovelli</td>
    <td>Italy</td>
  </tr>
</table>

@code {

  private string Query { get; set; } = string.Empty;

  private List<ProductSchema> Results { get; set; } = new();

  protected override void OnInitialized()
  {
    base.OnInitialized();
  }

  private void OnSearch()
  {
    if (string.IsNullOrEmpty(Query)) return;

    Results = ProductService.SearchProducts(Query.Trim()).ToList();
  }
}